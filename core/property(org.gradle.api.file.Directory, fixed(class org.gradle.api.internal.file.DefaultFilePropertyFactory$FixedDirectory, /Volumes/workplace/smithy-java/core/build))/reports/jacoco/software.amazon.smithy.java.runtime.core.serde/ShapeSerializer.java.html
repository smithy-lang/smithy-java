<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ShapeSerializer.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">core</a> &gt; <a href="index.source.html" class="el_package">software.amazon.smithy.java.runtime.core.serde</a> &gt; <span class="el_source">ShapeSerializer.java</span></div><h1>ShapeSerializer.java</h1><pre class="source lang-java linenums">/*
 * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
 * SPDX-License-Identifier: Apache-2.0
 */

package software.amazon.smithy.java.runtime.core.serde;

import java.io.Flushable;
import java.math.BigDecimal;
import java.math.BigInteger;
import java.time.Instant;
import java.util.function.BiConsumer;
import software.amazon.smithy.java.runtime.core.schema.PreludeSchemas;
import software.amazon.smithy.java.runtime.core.schema.SdkSchema;
import software.amazon.smithy.java.runtime.core.schema.SerializableStruct;
import software.amazon.smithy.java.runtime.core.serde.document.Document;

/**
 * Serializes a shape by receiving the Smithy data model and writing output to a receiver owned by the serializer.
 *
 * &lt;p&gt;Note: null values should only ever be written using {@link #writeNull(SdkSchema)}. Every other method expects
 * a non-null value or a value type.
 */
public interface ShapeSerializer extends Flushable, AutoCloseable {

    /**
     * Create a serializer that serializes nothing.
     *
     * @return the null serializer.
     */
    static ShapeSerializer nullSerializer() {
<span class="nc" id="L32">        return NullSerializer.INSTANCE;</span>
    }

    @Override
<span class="nc" id="L36">    default void flush() {}</span>

    @Override
<span class="nc" id="L39">    default void close() {}</span>

    /**
     * Writes a structure or union using the given member schema.
     *
     * @param schema A member schema that targets the given struct.
     * @param struct Structure to serialize.
     */
    void writeStruct(SdkSchema schema, SerializableStruct struct);

    /**
     * Writes a structure or union.
     *
     * @param struct Structure to serialize.
     */
    default void writeStruct(SerializableStruct struct) {
<span class="fc" id="L55">        writeStruct(struct.schema(), struct);</span>
<span class="fc" id="L56">    }</span>

    /**
     * Begin a list and write zero or more values into it using the provided serializer.
     *
     * @param schema    List schema.
     * @param listState State to pass into the consumer.
     * @param consumer  Received in the context of the list and writes zero or more values.
     */
    &lt;T&gt; void writeList(SdkSchema schema, T listState, BiConsumer&lt;T, ShapeSerializer&gt; consumer);

    /**
     * Begin a map and write zero or more entries into it using the provided serializer.
     *
     * @param schema   List schema.
     * @param mapState State to pass into the consumer.
     * @param consumer Received in the context of the map and writes zero or more entries.
     */
    &lt;T&gt; void writeMap(SdkSchema schema, T mapState, BiConsumer&lt;T, MapSerializer&gt; consumer);

    /**
     * Serialize a boolean.
     *
     * @param schema Schema of the shape.
     * @param value  Value to serialize.
     */
    void writeBoolean(SdkSchema schema, boolean value);

    /**
     * Serialize a byte.
     *
     * @param schema Schema of the shape.
     * @param value  Value to serialize.
     */
    void writeByte(SdkSchema schema, byte value);

    /**
     * Serialize a short.
     *
     * @param schema Schema of the shape.
     * @param value  Value to serialize.
     */
    void writeShort(SdkSchema schema, short value);

    /**
     * Serialize an integer.
     *
     * @param schema Schema of the shape.
     * @param value  Value to serialize.
     */
    void writeInteger(SdkSchema schema, int value);

    /**
     * Serialize a long.
     *
     * @param schema Schema of the shape.
     * @param value  Value to serialize.
     */
    void writeLong(SdkSchema schema, long value);

    /**
     * Serialize a float.
     *
     * @param schema Schema of the shape.
     * @param value  Value to serialize.
     */
    void writeFloat(SdkSchema schema, float value);

    /**
     * Serialize a double.
     *
     * @param schema Schema of the shape.
     * @param value  Value to serialize.
     */
    void writeDouble(SdkSchema schema, double value);

    /**
     * Serialize a big integer.
     *
     * @param schema Schema of the shape.
     * @param value  Value to serialize.
     */
    void writeBigInteger(SdkSchema schema, BigInteger value);

    /**
     * Serialize a big decimal.
     *
     * @param schema Schema of the shape.
     * @param value  Value to serialize.
     */
    void writeBigDecimal(SdkSchema schema, BigDecimal value);

    /**
     * Serialize a string.
     *
     * @param schema Schema of the shape.
     * @param value  String value.
     */
    void writeString(SdkSchema schema, String value);

    /**
     * Serialize a blob.
     *
     * @param schema Schema of the shape.
     * @param value  Blob value.
     */
    void writeBlob(SdkSchema schema, byte[] value);

    /**
     * Serialize a timestamp.
     *
     * @param schema Schema of the shape.
     * @param value  Timestamp value.
     */
    void writeTimestamp(SdkSchema schema, Instant value);

    /**
     * Serialize a document shape.
     *
     * &lt;p&gt;The underlying contents of the document can be serialized using {@link Document#serializeContents}.
     *
     * @param schema Schema of the shape. Generally this is {@link PreludeSchemas#DOCUMENT} unless the document
     *               wraps a modeled shape.
     * @param value  Value to serialize.
     */
    void writeDocument(SdkSchema schema, Document value);

    /**
     * Serialize a document shape using the schema {@link PreludeSchemas#DOCUMENT}.
     *
     * &lt;p&gt;This method is simply a shorter way to call:
     *
     * &lt;pre&gt;
     * serializer.writeDocument(PreludeSchemas.DOCUMENT, value);
     * &lt;/pre&gt;
     *
     * &lt;p&gt;This method should not be used when writing structures because member names are used when writing
     * structures, and the prelude schema for documents has no member name.
     *
     * @param value  Value to serialize.
     */
    default void writeDocument(Document value) {
<span class="fc" id="L198">        writeDocument(PreludeSchemas.DOCUMENT, value);</span>
<span class="fc" id="L199">    }</span>

    /**
     * Writes a null value.
     *
     * @param schema Schema of the null value.
     */
    void writeNull(SdkSchema schema);
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>